<!DOCTYPE html>
<html lang="zxx">

<head>
	<!-- Meta -->
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta name="author" content="">
	<!-- Page Title -->
    <title>Library</title>
	<!-- Favicon Icon -->
	<link rel="shortcut icon" type="image/x-icon" href="images/favicon.png">
	<!-- Google Fonts Css-->
	<link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Marcellus&amp;family=Sora:wght@100..800&amp;display=swap" rel="stylesheet">
	<!-- Bootstrap Css -->
	<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
	<!-- SlickNav Css -->
	<link href="css/slicknav.min.css" rel="stylesheet">
	<!-- Swiper Css -->
	<link rel="stylesheet" href="css/swiper-bundle.min.css">
	<!-- Font Awesome Icon Css-->
	<link href="css/all.min.css" rel="stylesheet" media="screen">
	<!-- Animated Css -->
	<link href="css/animate.css" rel="stylesheet">
    <!-- Magnific Popup Core Css File -->
	<link rel="stylesheet" href="css/magnific-popup.css">
	<!-- Mouse Cursor Css File -->
	<link rel="stylesheet" href="css/mousecursor.css">
	<!-- Main Custom Css -->
	<link href="css/custom.css" rel="stylesheet" media="screen">

    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    
    <style>
        /* Start Overlay */
        .start-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 99999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            color: white;
            text-align: center;
        }
    
        /* Widget Box */
        .agent-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 320px;
            height: 420px;
            background: rgba(25, 25, 25, 0.95);
            border: 2px solid #444;
            border-radius: 25px;
            display: none;
            flex-direction: column;
            z-index: 9999;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.9);
            animation: slideUp 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
    
        @keyframes slideUp {
            from {
                transform: translateY(100px);
                opacity: 0;
            }
    
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    
        .visual-area {
            flex: 1;
            position: relative;
            background: #111;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    
        .robot-avatar {
            font-size: 80px;
            color: #555;
            transition: all 0.3s;
            filter: drop-shadow(0 0 10px rgba(0, 255, 100, 0.2));
        }
    
        .robot-avatar.speaking {
            animation: pulse-speak 1s infinite;
            color: #00f260;
        }
    
        @keyframes pulse-speak {
            0% {
                transform: scale(1);
            }
    
            50% {
                transform: scale(1.1);
            }
    
            100% {
                transform: scale(1);
            }
        }
    
        #gestureCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            transform: scaleX(-1);
        }
    
        .info-area {
            height: 110px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            background: #1a1a1a;
        }
    
        .info-area h5 {
            color: #fff;
            margin: 0 0 5px 0;
            font-size: 18px;
        }
    
        .info-area p {
            color: #aaa;
            margin: 0;
            font-size: 13px;
            line-height: 1.4;
        }
    
        .status-badge {
            display: inline-block;
            font-size: 11px;
            font-weight: bold;
            color: #000;
            background: #333;
            color: #fff;
            padding: 2px 8px;
            border-radius: 4px;
            margin-bottom: 5px;
            width: fit-content;
        }
    
        #aiVideoSource {
            display: none;
        }
    </style>
</head>
<body>

    <!-- Preloader Start -->
	<div class="preloader">
		<div class="loading-container">
			<div class="loading"></div>
			<div id="loading-icon"><img src="images/favicon.png" alt=""></div>
		</div>
	</div>
	<!-- Preloader End -->

    <!-- Header Start -->
	<header class="main-header">
		<div class="header-sticky">
			<nav class="navbar navbar-expand-lg">
				<div class="container">
					<!-- Logo Start -->
					<a class="navbar-brand" href="index.html">
                        <img src="images/logo1.png" alt="Logo" style="width: 190px; height: auto;">
					</a>
					<!-- Logo End -->

					<!-- Main Menu Start -->
					<div class="collapse navbar-collapse main-menu">
                        <div class="nav-menu-wrapper">
                            <ul class="navbar-nav mr-auto" id="menu">
                                <li class="nav-item"><a class="nav-link" href="home.html">Home</a>
                                <li class="nav-item"><a class="nav-link" href="about.html">About Us</a>
                                <li class="nav-item"><a class="nav-link" href="catergories-voice.html">Library</a></li>
                                <li class="nav-item"><a class="nav-link" href="books-voice.html">Books</a></li>
                                <li class="nav-item submenu"><a class="nav-link" href="#">Pages</a>
                                    <ul>
                                        <li class="nav-item"><a class="nav-link" href="team.html">Our Team</a></li>
                                        <li class="nav-item"><a class="nav-link" href="pricing.html">Pricing Plan</a></li>
                                        <li class="nav-item"><a class="nav-link" href="testimonials.html">Testimonials</a></li>
                                        <li class="nav-item"><a class="nav-link" href="image-gallery.html">Image Gallery</a></li>
                                        <li class="nav-item"><a class="nav-link" href="video-gallery.html">Video Gallery</a></li>
                                    </ul>
                                </li>
                                <li class="nav-item"><a class="nav-link" href="contact.html">Contact Us</a></li>
                                <li class="nav-item highlighted-menu"><a class="nav-link" href="">Book Appointment</a></li>
                            </ul>
                        </div>
                        
                        <!-- Header Contact Btn Start -->
                        <div class="header-contact-btn">
                            <a href="tel:761853398" class="header-contact-now"><i class="fa-solid fa-phone-volume"></i>70 556 6003</a>
                            <a href="log-1.html" class="btn-default">Get Started</a>
                        </div>
                        <!-- Header Contact Btn End -->
					</div>
					<!-- Main Menu End -->
					<div class="navbar-toggle"></div>
				</div>
			</nav>
			<div class="responsive-menu"></div>
		</div>
	</header>
	<!-- Header End -->

    <!-- Page Header Start -->
    <div class="page-header parallaxie">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-12">
                    <!-- Page Header Box Start -->
                    <div class="page-header-box">
                        <h1 class="text-anime-style-2" data-cursor="-opaque">Library</h1>
                        <nav class="wow fadeInUp">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="index.html">home</a></li>
                                <li class="breadcrumb-item active" aria-current="page">Library</li>
                            </ol>
                        </nav>
                    </div>
                    <!-- Page Header Box End -->
                </div>
            </div>
        </div>
    </div>
    <!-- Page Header End -->

    <!-- Page Services Start -->
<div class="page-services">
    <div class="container">
        <div class="row section-row align-items-center">
            <div class="col-lg-6">
                <!-- Section Title Start -->
                <div class="section-title">
                    <h3 class="wow fadeInUp">categories</h3>
                    <h2 class="text-anime-style-2" data-cursor="-opaque">Explore our diverse <span>book categories</span> for every reader</h2>
                </div>
                <!-- Section Title End -->
            </div>

            <div class="col-lg-6">
                <!-- Section Button Start -->
                <div class="section-btn wow fadeInUp" data-wow-delay="0.2s">
                    <a href="#" id="viewAllBtn" class="btn-default">View All categories</a>
                </div>
                <!-- Section Button End -->
            </div>
        </div>

        <div class="row" id="servicesGrid">
            <!-- Item 1 -->
            <div class="col-lg-3 col-md-6 service-box">
                <div class="service-item wow fadeInUp">
                    <div class="service-header">
                        <div class="icon-box">
                            <img src="images/icon-service-item-1.svg" alt="">
                        </div>
                        <div class="service-btn">
                            <img src="images/arrow-white.svg" alt="">
                        </div>
                    </div>
                    <div class="service-content">
                        <h3>Fiction</h3>
                        <p>Explore novels, short stories, and literary works for enjoyment and imagination.</p>
                    </div>
                </div>
            </div>

            <!-- Item 2 -->
            <div class="col-lg-3 col-md-6 service-box">
                <div class="service-item wow fadeInUp" data-wow-delay="0.2s">
                    <div class="service-header">
                        <div class="icon-box">
                            <img src="images/icon-service-item-2.svg" alt="">
                        </div>
                        <div class="service-btn">
                            <img src="images/arrow-white.svg" alt="">
                        </div>
                    </div>
                    <div class="service-content">
                        <h3>Science & Technology</h3>
                        <p>Access books on computing, engineering, biology, and the latest tech trends.</p>
                    </div>
                </div>
            </div>

            <!-- Item 3 -->
            <div class="col-lg-3 col-md-6 service-box">
                <div class="service-item wow fadeInUp" data-wow-delay="0.4s">
                    <div class="service-header">
                        <div class="icon-box">
                            <img src="images/icon-service-item-3.svg" alt="">
                        </div>
                        <div class="service-btn">
                            <img src="images/arrow-white.svg" alt="">
                        </div>
                    </div>
                    <div class="service-content">
                        <h3>History</h3>
                        <p>Learn about ancient civilizations, world wars, and key historical events.</p>
                    </div>
                </div>
            </div>

            <!-- Item 4 -->
            <div class="col-lg-3 col-md-6 service-box">
                <div class="service-item wow fadeInUp" data-wow-delay="0.6s">
                    <div class="service-header">
                        <div class="icon-box">
                            <img src="images/icon-service-item-4.svg" alt="">
                        </div>
                        <div class="service-btn">
                            <img src="images/arrow-white.svg" alt="">
                        </div>
                    </div>
                    <div class="service-content">
                        <h3>Self-Help & Motivation</h3>
                        <p>Boost your mindset and productivity with inspiring self-help titles.</p>
                    </div>
                </div>
            </div>

            <!-- Hidden Items Start -->
            <div class="col-lg-3 col-md-6 service-box d-none extra-service">
                <div class="service-item wow fadeInUp" data-wow-delay="0.1s">
                    <div class="service-header">
                        <div class="icon-box">
                            <img src="images/icon-service-item-5.svg" alt="">
                        </div>
                        <div class="service-btn">
                            <img src="images/arrow-white.svg" alt="">
                        </div>
                    </div>
                    <div class="service-content">
                        <h3>Biography</h3>
                        <p>Read life stories of influential people, leaders, and icons.</p>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6 service-box d-none extra-service">
                <div class="service-item wow fadeInUp" data-wow-delay="0.2s">
                    <div class="service-header">
                        <div class="icon-box">
                            <img src="images/icon-service-item-6.svg" alt="">
                        </div>
                        <div class="service-btn">
                            <img src="images/arrow-white.svg" alt="">
                        </div>
                    </div>
                    <div class="service-content">
                        <h3>Children's Books</h3>
                        <p>Engage young minds with stories and educational content for kids.</p>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6 service-box d-none extra-service">
                <div class="service-item wow fadeInUp" data-wow-delay="0.3s">
                    <div class="service-header">
                        <div class="icon-box">
                            <img src="images/icon-service-item-7.svg" alt="">
                        </div>
                        <div class="service-btn">
                            <img src="images/arrow-white.svg" alt="">
                        </div>
                    </div>
                    <div class="service-content">
                        <h3>Poetry</h3>
                        <p>Dive into expressive verses from classical and contemporary poets.</p>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6 service-box d-none extra-service">
                <div class="service-item wow fadeInUp" data-wow-delay="0.4s">
                    <div class="service-header">
                        <div class="icon-box">
                            <img src="images/icon-service-item-8.svg" alt="">
                        </div>
                        <div class="service-btn">
                            <img src="images/arrow-white.svg" alt="">
                        </div>
                    </div>
                    <div class="service-content">
                        <h3>Sinhala Literature</h3>
                        <p>Celebrate local heritage with timeless Sinhala literary works.</p>
                    </div>
                </div>
            </div>
            <!-- Hidden Items End -->

            <div class="col-lg-12">
                <div class="section-footer-text wow fadeInUp" data-wow-delay="0.6s">
                    <p><span>Library</span> Discover more categories or request a book. <a href="contact.html">Contact Us</a></p>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Page Services End -->

<!-- Add this script -->
<script>
    document.getElementById("viewAllBtn").addEventListener("click", function (e) {
        e.preventDefault();
        const hiddenItems = document.querySelectorAll(".extra-service");
        hiddenItems.forEach((item, i) => {
            item.classList.remove("d-none");
            setTimeout(() => {
                item.classList.add("animate__animated", "animate__fadeInUp");
            }, i * 100);
        });
        this.style.display = "none"; // Hide the button after showing
    });
</script>

<!-- Make sure WOW.js and animate.css are included in your project for animation to work properly -->



    

    <!-- Footer Main Start -->
<footer class="footer-main">
    <div class="container" >
        <div class="row">
            <div class="col-lg-12">
                <!-- Footer Header Start -->
                <div class="footer-header">
                    <!-- Footer About Start -->
                    <div class="footer-about">
                        <div class="footer-logo">
                            <img src="images/logo1.png" alt="Footer Logo">
                        </div>
                        <div class="about-footer-content">
                            <p>Empowering visually impaired students with accessible audiobooks for enhanced learning.</p>
                        </div>
                    </div>
                    <!-- Footer About End -->
                    
                    <!-- Footer Social Links Start -->
                    <div class="footer-social-links">
                        <ul>
                            <li><a href="#"><i class="fa-brands fa-pinterest-p"></i></a></li>
                            <li><a href="#"><i class="fa-brands fa-x-twitter"></i></a></li>
                            <li><a href="#"><i class="fa-brands fa-facebook-f"></i></a></li>
                            <li><a href="#"><i class="fa-brands fa-instagram"></i></a></li>
                        </ul>
                    </div>
                    <!-- Footer Social Links End -->
                </div>
                <!-- Footer Header End -->
            </div>

            <div class="col-lg-2 col-md-3">
                <!-- Footer Links Start -->
                <div class="footer-links">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="index-2.html">Home</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="catergories.html">Library</a></li>
                        <li><a href="blog.html">Books</a></li>
                    </ul>
                </div>
                <!-- Footer Links End -->
            </div>

            <div class="col-lg-2 col-md-4">
                <!-- Footer Links Start -->
                <div class="footer-links">
                    <h3>Services</h3>
                    <ul>
                        <li><a href="service-single.html">Audiobook Creation</a></li>
                        <li><a href="service-single.html">Learning Resources</a></li>
                        <li><a href="service-single.html">Narration Services</a></li>
                        <li><a href="service-single.html">Educational Tools</a></li>
                    </ul>
                </div>
                <!-- Footer Links End -->
            </div>

            <div class="col-lg-3 col-md-5">
                <!-- Footer Contact Links Start -->
                <div class="footer-links footer-contact-links">
                    <h3>Contact</h3>
                    <ul>
                        <li><a href="tel:761852398">+94 70 556 6003 </a></li>
                        <li><a href="mailto:info@domainname.com">info@voiceaccess.com</a></li>
                        <li>SLTC Padukka</li>
                    </ul>
                </div>
                <!-- Footer Contact Links End -->
            </div>
            
            <div class="col-lg-5">
                <!-- Footer Newsletter Box Start -->
                <div class="footer-newsletter-box">
                    <!-- Footer Newsletter Title Start -->
                    <div class="section-title">
                        <h2 class="text-anime-style-2" data-cursor="-opaque">Subscribe for Audiobook Updates and Educational Resources</h2>
                    </div>
                    <!-- Footer Newsletter Title End -->

                    <!-- Newsletter Form Start -->
                    <div class="newsletter-form">
                        <form id="newsletterForm" action="#" method="POST">
                            <div class="form-group">
                                <input type="email" name="email" class="form-control" id="mail" placeholder="Enter Your Email" required>
                                <button type="submit" class="newsletter-btn"><i class="fa-solid fa-paper-plane"></i></button>
                            </div>
                        </form>
                    </div>
                    <!-- Newsletter Form End -->
                </div>
                <!-- Footer Newsletter Box End -->
            </div>

            <div class="col-lg-12">
                <!-- Footer Copyright Section Start -->
                <div class="footer-copyright">
                    <!-- Footer Copyright Text Start -->
                    <div class="footer-copyright-text">
                        <p>Copyright © 2025 All Rights Reserved.</p>
                    </div>
                    <!-- Footer Copyright Text End -->
                            
                    <!-- Footer Privacy Policy Start -->
                    <div class="footer-privacy-policy">
                        <ul>
                            <li><a href="#">Privacy Policy</a></li>
                            <li><a href="#">Terms & Conditions</a></li>
                            <li><a href="#">Help</a></li>
                        </ul>
                    </div>
                    <!-- Footer Privacy Policy End -->
                </div>
                <!-- Footer Copyright Section End -->
            </div>
        </div>
    </div>
</footer>
<!-- Footer Main End -->

    <!-- Jquery Library File -->
    <script src="js/jquery-3.7.1.min.js"></script>
    <!-- Bootstrap js file -->
    <script src="js/bootstrap.min.js"></script>
    <!-- Validator js file -->
    <script src="js/validator.min.js"></script>
    <!-- SlickNav js file -->
    <script src="js/jquery.slicknav.js"></script>
    <!-- Swiper js file -->
    <script src="js/swiper-bundle.min.js"></script>
    <!-- Counter js file -->
    <script src="js/jquery.waypoints.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <!-- Magnific js file -->
    <script src="js/jquery.magnific-popup.min.js"></script>
    <!-- SmoothScroll -->
    <script src="js/SmoothScroll.js"></script>
    <!-- Parallax js -->
    <script src="js/parallaxie.js"></script>
    <!-- MagicCursor js file -->
    <script src="js/gsap.min.js"></script>
    <script src="js/magiccursor.js"></script>
    <!-- Text Effect js file -->
    <script src="js/SplitText.js"></script>
    <script src="js/ScrollTrigger.min.js"></script>
    <!-- YTPlayer js File -->
    <script src="js/jquery.mb.YTPlayer.min.js"></script>
    <!-- Wow js file -->
    <script src="js/wow.min.js"></script>
    <!-- Main Custom js file -->
    <script src="js/function.js"></script>

    <div class="start-overlay" id="blindStartOverlay">
        <div
            style="border: 3px solid #00f260; padding: 30px; border-radius: 50%; margin-bottom: 20px; animation: pulse 2s infinite;">
            <i class="fa-solid fa-book-open" style="font-size: 50px; color: #00f260;"></i>
        </div>
        <h1>Tap to Select Category</h1>
        <p style="color: #888; margin-top: 10px;">Voice Assisted Library</p>
    </div>
    
    <video id="aiVideoSource" playsinline></video>
    
    <div class="agent-widget" id="agentWidget">
        <div class="visual-area">
            <div class="robot-avatar" id="robotIcon"><i class="fa-solid fa-robot"></i></div>
            <canvas id="gestureCanvas"></canvas>
        </div>
        <div class="info-area">
            <span class="status-badge" id="statusBadge">SYSTEM IDLE</span>
            <h5 id="agentTitle">Library Assistant</h5>
            <p id="agentText">Waiting for user...</p>
        </div>
    </div>

    <script>
        $(document).ready(function() {
                const overlay = $('#blindStartOverlay');
                const widget = $('#agentWidget');
                const videoElement = document.getElementById('aiVideoSource');
                const canvasElement = document.getElementById('gestureCanvas');
                const canvasCtx = canvasElement.getContext('2d');
                const robotIcon = $('#robotIcon');
                
                let state = "WAITING_TOUCH"; 
                let lastSpokenTime = 0;
                let selectedCategory = "";
    
                // 1. පටන් ගැනීම
                overlay.click(function() {
                    overlay.fadeOut();
                    widget.css("display", "flex");
                    initAI();
                });
    
                function initAI() {
                    updateUI("Initializing", "Please wait...", "LOADING");
                    speak("Welcome to the Library. I am starting the camera.", () => {
                        startCamera();
                    });
                }
    
                function startCamera() {
                    const hands = new Hands({locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`});
                    hands.setOptions({ maxNumHands: 1, modelComplexity: 1, minDetectionConfidence: 0.6, minTrackingConfidence: 0.5 });
                    hands.onResults(onResults);
    
                    const camera = new Camera(videoElement, {
                        onFrame: async () => { await hands.send({image: videoElement}); },
                        width: 640, height: 480
                    });
                    camera.start();
    
                    // Detailed Intro
                    setTimeout(() => {
                        updateUI("Listening...", "Explaining Categories", "SPEAKING");
                        const introMessage = "You are on the Library Page. Here are the options. " + 
                                             "Show one finger for Novels. " + 
                                             "Show two fingers for Short Stories. " + 
                                             "Show three fingers for Translations. " + 
                                             "And show four fingers for History. " +
                                             "I am listening now.";
    
                        speak(introMessage, () => {
                            state = "LISTENING_CMD";
                            updateUI("Ready", "Show 1, 2, 3 or 4 Fingers", "READY");
                        });
                    }, 4000);
                }
    
                function onResults(results) {
                    canvasElement.width = videoElement.videoWidth;
                    canvasElement.height = videoElement.videoHeight;
                    canvasCtx.save();
                    canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
    
                    if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
                        robotIcon.hide();
                        $(canvasElement).show();
                        const lm = results.multiHandLandmarks[0];
                        
                        drawConnectors(canvasCtx, lm, HAND_CONNECTIONS, {color: '#00f260', lineWidth: 3});
                        drawLandmarks(canvasCtx, lm, {color: '#ff0000', lineWidth: 1});
    
                        checkGestures(lm);
                    } else {
                        $(canvasElement).hide();
                        robotIcon.show();
                    }
                    canvasCtx.restore();
                }
    
                function checkGestures(lm) {
                    const indexUp = lm[8].y < lm[6].y;
                    const middleUp = lm[12].y < lm[10].y;
                    const ringUp = lm[16].y < lm[14].y;
                    const pinkyUp = lm[20].y < lm[18].y;
                    
                    const isThumbUp = lm[4].y < lm[3].y; 
                    const isThumbDown = lm[4].y > lm[3].y;
    
                    const now = new Date().getTime();
                    if (now - lastSpokenTime < 3500) return;
    
                    // ---------------------------------------------------------
                    // STEP 1: Select Category
                    // ---------------------------------------------------------
                    if (state === "LISTENING_CMD") {
                        if (indexUp && !middleUp && !ringUp && !pinkyUp) confirmSelection("Novels");
                        else if (indexUp && middleUp && !ringUp && !pinkyUp) confirmSelection("Short Stories");
                        else if (indexUp && middleUp && ringUp && !pinkyUp) confirmSelection("Translations");
                        else if (indexUp && middleUp && ringUp && pinkyUp) confirmSelection("History");
                    }
    
                    // ---------------------------------------------------------
                    // STEP 2: Verify Selection (Thumbs Up / Down)
                    // ---------------------------------------------------------
                    else if (state === "VERIFY_SELECTION") {
                        
                        // YES (Thumbs Up)
                        if (isThumbUp && !indexUp && !middleUp && !ringUp && !pinkyUp) {
                            lastSpokenTime = now;
    
                            // මෙන්න වෙනස් කරපු තැන (Only 'Novels' works)
                            if (selectedCategory === "Novels") {
                                state = "REDIRECTING";
                                updateUI("Success", "Opening Novels...", "SUCCESS");
                                speak("Great. Opening Novels books.", () => {
                                    window.location.href = "books-voice.html";
                                });
                            } else {
                                // අනිත් Categories සඳහා "Sorry" කියනවා
                                state = "LISTENING_CMD"; // ආපහු තෝරන්න දෙනවා
                                updateUI("Empty", "No Books Yet", "IDLE");
                                speak("Sorry. There are currently no books available in " + selectedCategory + ". Please choose another category.");
                            }
                        }
                        
                        // NO (Thumbs Down) - Cancel
                        else if (isThumbDown && !indexUp && !middleUp && !ringUp && !pinkyUp) {
                            state = "LISTENING_CMD";
                            lastSpokenTime = now;
                            updateUI("Retry", "Show 1, 2, 3 or 4", "IDLE");
                            speak("Okay. Let's choose again. Show 1, 2, 3, or 4 fingers.");
                        }
                    }
                }
    
                function confirmSelection(catName) {
                    selectedCategory = catName;
                    state = "VERIFY_SELECTION";
                    lastSpokenTime = new Date().getTime();
                    updateUI("Confirm?", `Did you choose ${catName}?`, "WAITING");
                    speak(`Did you choose ${catName}? Show Thumbs Up for Yes, Thumbs Down for No.`);
                }
    
                function updateUI(title, text, badge) {
                    $('#agentTitle').text(title);
                    $('#agentText').text(text);
                    $('#statusBadge').text(badge);
                    
                    if (badge === "SUCCESS") $('#statusBadge').css('background', '#00f260');
                    else if (badge === "WAITING" || badge === "SPEAKING") $('#statusBadge').css('background', '#ffc107');
                    else $('#statusBadge').css('background', '#333');
                }
    
                function speak(text, callback) {
                    window.speechSynthesis.cancel();
                    const utterance = new SpeechSynthesisUtterance(text);
                    robotIcon.addClass('speaking');
                    utterance.onend = function() {
                        robotIcon.removeClass('speaking');
                        if (callback) callback();
                    };
                    window.speechSynthesis.speak(utterance);
                }
            });
    </script>
</body>

</html>